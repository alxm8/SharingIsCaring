function Get-StoppedServices {
    Invoke-Command -ComputerName (Get-ADComputer -Filter { OperatingSystem -like '*server*' } | Select-Object -ExpandProperty Name) -ErrorAction SilentlyContinue -ScriptBlock { Get-Service | where { $_.Status -ne "Running" -and $_.StartType -like "Automatic*" -and $_.DisplayName -NotLike "*Biometric*" -and $_.DisplayName -NotLike "*Watchdog*" -and $_.DisplayName -NotLike "*Software Protection*" -and $_.DisplayName -NotLike "*Maps Manager*" -and $_.DisplayName -NotLike "*Remote Registry*" -and $_.DisplayName -NotLike "*ccmsetup*" -and $_.DisplayName -NotLike "*gupdate*" -and $_.DisplayName -NotLike "*NGEN v*" -and $_.DisplayName -NotLike "*Background Intelligent*" -and $_.DisplayName -NotLike "*Windows Modules*"} }
}
function Start-StoppedServices {
    Invoke-Command -ComputerName (Get-ADComputer -Filter { OperatingSystem -like '*server*' } | Select-Object -ExpandProperty Name) -ScriptBlock { Get-Service | where { $_.Status -ne "Running" -and $_.StartType -like "Automatic*" -and $_.DisplayName -NotLike "*Biometric*" -and $_.DisplayName -NotLike "*Watchdog*" -and $_.DisplayName -NotLike "*Software Protection*" -and $_.DisplayName -NotLike "*Maps Manager*" -and $_.DisplayName -NotLike "*Remote Registry*" -and $_.DisplayName -NotLike "*ccmsetup*" -and $_.DisplayName -NotLike "*gupdate*" -and $_.DisplayName -NotLike "*NGEN v*" -and $_.DisplayName -NotLike "*Background Intelligent*" -and $_.DisplayName -NotLike "*Windows Modules*"} | start-service }
}
